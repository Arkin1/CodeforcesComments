<p>Here are two alternate solutions for F. (Neither one uses any prior knowledge about the Stirling numbers.)</p>   <div class="spoiler"><b class="spoiler-title">Simple no-FFT solution</b><div class="spoiler-content" style="display: none;"><p>As in the main editorial, consider the related problem with only operations of type $$$G$$$. Applying several operations of type $$$G$$$ to an array is equivalent to applying some permutation to the codomain $$$\{1 \ldots k\}$$$ of the array. Since these operations are invertible, and we need to count equivalence classes with respect to this operation, it makes sense to try  <submission link> </p></div></div> <<===>> 
