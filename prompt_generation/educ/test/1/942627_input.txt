((-1, 942627)) => <div class="ttypography"><p>I accepted f in the contest, my solution is $$$O(qn \log n)$$$. Maybe because of the large constant, it fst.</p></div>
((942627, 942630)) => <div class="ttypography"><p>And I don't know why it get wa when I optimize it.</p></div>
((942630, 942649)) => <div class="ttypography"><p>for vertices i,j the distance shall be $$$min(f[i]+f[j]+x,dis(i,j))$$$, f[i] means the distance between i and the nearest leaf. I sort f, and check whether the answer can be bigger than ans. Then for every node, it is a suffix of j that $$$f[i]+f[j]+x&gt;=ans$$$ . I prework the suffix diameter and use O(1) lca to find the distance.</p></div>
